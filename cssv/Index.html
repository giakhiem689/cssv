<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f0f4f8;
      color: #333;
    }


.toolbar {
  background: linear-gradient(90deg, #ff4b4b, #ff0000);
  color: white;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 13px;
  font-size: 16px;
  font-weight: 600;
  box-shadow: 0px 6px 15px rgba(255, 0, 0, 0.3); /* Hiệu ứng nổi 3D với bóng đổ */
  position: fixed;       /* Giữ toolbar cố định khi cuộn */
  top: 0;                /* Gắn toolbar ở phía trên cùng */
  left: 0;
  width: 100%;           /* Chiều rộng full */
  z-index: 1000;         /* Hiển thị trên các phần tử khác */
  border-bottom: 2px solid #cc0000; /* Viền dưới tạo điểm nhấn */
}


/* Để tránh nội dung bị che khuất bởi toolbar */
body {
  padding-top: 65px;    /* Đẩy nội dung xuống dưới toolbar */
}

.toolbar-title {
  letter-spacing: 1px;
  text-transform: uppercase;
  font-size: 16px;
  font-weight: bold;
}

.menu {
  display: flex;
  gap: 10px;
  margin-right: 80px;            /* Xóa margin để menu không bị đẩy xuống */
  padding: 0;           /* Xóa padding nếu có */
}


/* Các Mục Menu */
.menu a {
  color: white;
  text-decoration: none;
  font-size: 15px;
  padding: 5px;
  background-color: #FF0000;
  border-radius: 3px;
  transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
}

/* Hiệu Ứng Hover Cho Menu */
.menu a:hover {
  background-color: #BB0000;     /* Màu xanh đậm hơn khi hover */
  transform: translateY(-3px);   /* Dịch chuyển lên trên */
  box-shadow: 0px 6px 15px rgba(0, 91, 187, 0.4); /* Bóng đổ để tạo hiệu ứng 3D */
}


    header {
      background-color: #FFFFFF;
      color: red;
      padding: 20px;
      text-align: center;
      font-size: 28px;
      font-weight: bold;
      text-transform: uppercase;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }

    main {
      padding: 20px;
      max-width: auto;
      margin: 30px auto;
      background-color: white;
      box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.1);
      border-radius: 10px;
    }

    .search-section {
      text-align: center;
      margin-bottom: 30px;
    }

    input[type="text"] {
      width: 300px;
      padding: 12px;
      border: 2px solid #FF0000;
      border-radius: 25px;
      outline: none;
      font-size: 16px;
      transition: all 0.3s;
    }

    button {
      padding: 12px 25px;
      background-color: #FF0000;
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s, transform 0.3s;
    }

    button:hover {
      background-color: #CC0000;
      transform: translateY(-2px);
    }

    .loading {
      display: none;
      font-size: 16px;
      color: #FF0000;
      margin-top: 10px;
    }

    .loading::after {
    content: '⏳';
    margin-left: 10px;
    animation: spin 1s linear infinite;
    }

    @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
    }

    .search-results {
      margin-top: 20px;
      text-align: left;
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.1);
    }

    .student-info {
      background-color: #fff;
      padding: 15px;
      border: 2px solid #FF0000;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0px 4px 15px rgba(255, 0, 0, 0.2);
    }

    .student-info h3 {
      margin: 0 0 15px;
      font-size: 24px;
      color: #FF0000;
      text-align: center;
      border-bottom: 2px solid #FF0000;
      padding-bottom: 10px;
    }

    .care-details {
      background-color: #ffefef;
      border-left: 5px solid #FF0000;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      font-size: 16px;
      font-weight: bold;
      color: #333;
      box-shadow: 0px 2px 10px rgba(255, 0, 0, 0.1);
    }

    .care-details:hover {
      transform: translateX(5px);
      background-color: #ffe6e6;
      box-shadow: 0px 4px 15px rgba(255, 0, 0, 0.2);

    }
    .care-summary {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      justify-content: center;
      margin-top: 10px;
    }

    .care-summary .care-info {
      background-color: #fff3f3;
      border: 2px solid #FF0000;
      border-radius: 10px;
      padding: 15px;
      width: 190px;
      text-align: center;
      box-shadow: 0px 4px 15px rgba(255, 0, 0, 0.1);
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
    }

    .care-summary .care-info:hover {
      transform: translateY(-5px) scale(1.05);;
      box-shadow: 0px 10px 20px rgba(255, 0, 0, 0.2);
      background-color: #ffdddd;
    }


    footer {
      background-color: #FF0000;
      color: white;
      text-align: center;
      padding: 10px;
      position: fixed;
      bottom: 0;
      width: 100%;
      font-size: 14px;
    }
  </style>
  <script>
    function fetchData() {
      google.script.run.withSuccessHandler(displayCareSummary).getSheetData();
    }

    function displayCareSummary(data) {
      let careCounts = {};

      data.slice(1).forEach(row => {
        row.slice(3).forEach((care, index) => {
          if (care) {
            const careKey = data[0][index + 3];
            if (!careCounts[careKey]) {
              careCounts[careKey] = 0;
            }
            careCounts[careKey]++;
          }
        });
      });

      let careSummaryHTML = Object.entries(careCounts).map(([care, count]) => `
        <div class="care-info">
          <h4>${care}</h4>
          <p>${count} sinh viên</p>
        </div>
      `).join('');

      document.getElementById('careSummary').innerHTML = careSummaryHTML;
    }

    function searchStudent() {
      const loadingElement = document.getElementById('loading');
      loadingElement.style.display = 'block';

      const searchKey = document.getElementById('searchInput').value.trim().toLowerCase();
      google.script.run.withSuccessHandler(data => {
        loadingElement.style.display = 'none';

        let result = '';
        let found = false;

        data.slice(1).forEach(row => {
          if (row[1].toString().toLowerCase() === searchKey) {
            found = true;
            let careDetails = row.slice(3).filter(care => care).map(care => `
              <div class="care-details">
                ${care}
              </div>
            `).join('');
            let careCount = row.slice(3).filter(care => care).length;

            result = `
              <div class="student-info">
                <h3>Thông Tin Sinh Viên</h3>
                <p><strong>MSSV:</strong> ${row[1]}</p>
                <p><strong>Họ và Tên:</strong> ${row[2]}</p>
                <p><strong>Tổng Số Đợt Chăm Sóc:</strong> ${careCount}</p>
                <p><strong>Nội Dung Chăm Sóc:</strong></p>
                ${careDetails || '<div class="care-details">Không có đợt chăm sóc nào</div>'}
              </div>
            `;
          }
        });

        document.getElementById('searchResults').innerHTML = found ? result : `<p>Không tìm thấy sinh viên nào.</p>`;
      }).getSheetData();
    }

    window.onload = fetchData;
  </script>
</head>
<body>

<div class="toolbar">
    <span class="toolbar-title">Trung Tâm Hỗ Trợ Học Vụ UEF</span>
  <div class="menu">
    <a href="https://docs.google.com/spreadsheets/d/1wh0TT2D9qpECQwv9L9_ovAWUxfSew4uCTF8DNjbFCQo/edit?gid=0#gid=0">Import</a>
  </div>
</div>


  <header>
    Thống Kê Chăm Sóc Sinh Viên
  </header>

  <main>
    <div class="search-section">
      <h3>Tìm Kiếm Sinh Viên</h3>
      <input type="text" id="searchInput" placeholder="Nhập MSSV">
      <button onclick="searchStudent()">Tìm kiếm</button>
      <div id="loading" class="loading">Đang tìm kiếm...</div>
    </div>

    <div id="searchResults" class="search-results"></div>

    <div class="care-summary" id="careSummary"></div>
  </main>

  <footer>
    &copy; 2024 Trung Tâm Hỗ Trợ Học Vụ UEF - Gia Khiêm. All Rights Reserved.
  </footer>
</body>
</html>
